# Story 3.3: Financial Performance Widget

## Status
Ready

## Story
**As a** Sales Leader,
**I want** a financial performance widget that tracks sales against our quarterly and annual targets,
**so that** I can monitor progress towards our financial goals.

## Acceptance Criteria
1. A widget on the dashboard displays the Annual Sales Target and the current Quarterly Sales Target (these values will be configured in the admin settings).
2. The widget shows the sum of the value of all opportunities marked as "Closed - Awarded" within the relevant time period.
3. A visual element, like a progress bar or gauge, clearly shows the percentage of the target that has been achieved.
4. The widget's data updates in real-time when an opportunity is won.

## Tasks / Subtasks
- [ ] Task 1 (AC: 1)
  - [ ] Create admin settings for quarterly and annual targets
  - [ ] Implement target configuration interface
  - [ ] Store target values in Firebase/Firestore

- [ ] Task 2 (AC: 2)
  - [ ] Calculate sum of "Closed Won" opportunities by time period
  - [ ] Implement quarterly and annual date filtering
  - [ ] Add revenue tracking service

- [ ] Task 3 (AC: 3)
  - [ ] Enhance financial widget with gauge/progress visualization
  - [ ] Add target vs actual comparison charts
  - [ ] Implement percentage completion indicators

- [ ] Task 4 (AC: 4)
  - [ ] Implement real-time updates for won opportunities
  - [ ] Add automatic recalculation on data changes
  - [ ] Optimize performance for large datasets

## Dev Notes
- Previous Story Insights: Basic FinancialPerformanceWidget already exists from Story 3.1
- Enhancement Focus: Add target management, real-time tracking, visual progress indicators
- Configuration: Store targets in Firebase with admin-only access
- Calculations: Filter opportunities by date ranges for quarterly/annual tracking
- Visualization: Use circular progress indicators and trend charts

## Testing
- Test file location: `src/app/features/dashboard/widgets/financial-performance-widget.component.spec.ts`
- Framework: Jasmine with Angular TestBed
- Patterns: Test target calculations, date filtering, real-time updates, admin permissions

## Change Log
| Date       | Version | Description                    | Author       |
|------------|---------|--------------------------------|--------------|
| 2025-08-03 | 0.1     | Initial draft of Story 3.3     | Scrum Master |

## Dev Agent Record
### Agent Model Used
*To be filled by Dev Agent*

### Debug Log References
*To be filled by Dev Agent*

### Completion Notes List
*To be filled by Dev Agent*
