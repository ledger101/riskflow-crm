import{a as f,j as t,k as s,l as u,m as g,p as o,q as n,r as m,t as h,u as p}from"./chunk-6HUQKW6B.js";import{$ as l,e as i,ea as d}from"./chunk-UAJ5BYCW.js";var v=class a{constructor(r){this.firebaseService=r;this.auth=this.firebaseService.getAuth(),this.firestore=this.firebaseService.getFirestore()}auth;firestore;createUser(r){return i(this,null,function*(){let e=yield f(this.auth,r.email,r.password);yield n(s(this.firestore,"userRoles",e.user.uid),{name:r.name,email:r.email,role:r.role,confirmed:!0,confirmedAt:new Date})})}inviteUser(r){return i(this,null,function*(){return(yield h(t(this.firestore,"userRoles"),{name:r.name,email:r.email,role:r.role,confirmed:!1,invitedAt:new Date})).id})}markUserConfirmed(r,e){return i(this,null,function*(){let w=s(this.firestore,"userRoles",r),c=yield o(u(t(this.firestore,"userRoles"),g("email","==",e)));if(c.empty)yield n(w,{email:e,confirmed:!0,confirmedAt:new Date,role:"Read-Only"});else{let A=c.docs[0];yield m(A.ref,{confirmed:!0,confirmedAt:new Date})}})}updateUser(r,e){return i(this,null,function*(){yield m(s(this.firestore,"userRoles",r),e)})}getUsers(){return i(this,null,function*(){return(yield o(t(this.firestore,"userRoles"))).docs.map(e=>({id:e.id,name:e.data().name||"",email:e.data().email||"",role:e.data().role||"",confirmed:e.data().confirmed??!0,invitedAt:e.data().invitedAt||null,confirmedAt:e.data().confirmedAt||null}))})}static \u0275fac=function(e){return new(e||a)(d(p))};static \u0275prov=l({token:a,factory:a.\u0275fac,providedIn:"root"})};export{v as a};
