import{a as V}from"./chunk-WP5SVQ3H.js";import"./chunk-JRVZ5TRL.js";import{c as U,e as c,f as w,g as T,i as N,k as q,l as M,m as R,n as A,o as O,s as G,u as D}from"./chunk-N72T7JVJ.js";import{f as y,h as b}from"./chunk-3L2WMKXX.js";import{Cb as S,Dc as I,Eb as u,Gc as h,Mb as m,Nb as g,Ob as C,Vb as E,Wa as l,Xa as p,e as x,ja as F,kb as d,ob as a,tb as n,ub as r,vb as _}from"./chunk-UAJ5BYCW.js";function P(t,o){t&1&&(n(0,"div"),m(1,"Name is required"),r())}function B(t,o){if(t&1&&(n(0,"div",16),d(1,P,2,0,"div",14),r()),t&2){let e,i=u();l(),a("ngIf",(e=i.userForm.get("name"))==null||e.errors==null?null:e.errors.required)}}function k(t,o){t&1&&(n(0,"div"),m(1,"Email is required"),r())}function z(t,o){t&1&&(n(0,"div"),m(1,"Enter a valid email"),r())}function H(t,o){if(t&1&&(n(0,"div",16),d(1,k,2,0,"div",14)(2,z,2,0,"div",14),r()),t&2){let e,i,s=u();l(),a("ngIf",(e=s.userForm.get("email"))==null||e.errors==null?null:e.errors.required),l(),a("ngIf",(i=s.userForm.get("email"))==null||i.errors==null?null:i.errors.email)}}function J(t,o){t&1&&(n(0,"div"),m(1,"Password is required"),r())}function K(t,o){if(t&1&&(n(0,"div",16),d(1,J,2,0,"div",14),r()),t&2){let e,i=u(2);l(),a("ngIf",(e=i.userForm.get("password"))==null||e.errors==null?null:e.errors.required)}}function L(t,o){if(t&1&&(n(0,"div",3)(1,"label",4),m(2,"Password"),r(),_(3,"input",17),d(4,K,2,1,"div",6),r()),t&2){let e,i=u();l(4),a("ngIf",((e=i.userForm.get("password"))==null?null:e.touched)&&((e=i.userForm.get("password"))==null?null:e.invalid))}}function Q(t,o){t&1&&(n(0,"div"),m(1,"Role is required"),r())}function W(t,o){if(t&1&&(n(0,"div",16),d(1,Q,2,0,"div",14),r()),t&2){let e,i=u();l(),a("ngIf",(e=i.userForm.get("role"))==null||e.errors==null?null:e.errors.required)}}function X(t,o){t&1&&(n(0,"span"),m(1,"Processing..."),r())}function Y(t,o){if(t&1&&(n(0,"span"),m(1),r()),t&2){let e=u();l(),g(e.isEdit?"Update User":"Create User")}}function Z(t,o){if(t&1&&(n(0,"div",18),m(1),r()),t&2){let e=u();l(),C(" ",e.errorMessage," ")}}var j=class t{constructor(o,e,i,s){this.fb=o;this.route=e;this.router=i;this.userService=s;this.userForm=this.fb.group({name:["",c.required],email:["",[c.required,c.email]],password:[""],role:["",c.required]})}userForm;isEdit=!1;userId=null;loading=!1;errorMessage=null;ngOnInit(){this.userId=this.route.snapshot.paramMap.get("id"),this.isEdit=!!this.userId,this.isEdit&&this.userId&&this.userService.getUsers().then(o=>{let e=o.find(i=>i.id===this.userId);e&&this.userForm.patchValue({name:e.name||"",email:e.email,role:e.role})})}onSubmit(){return x(this,null,function*(){if(this.userForm.invalid){console.log("Invalid Form");return}console.log("loading"),this.loading=!0,this.errorMessage=null;try{let{name:o,email:e,password:i,role:s}=this.userForm.value;this.isEdit&&this.userId?yield this.userService.updateUser(this.userId,{name:o,email:e,role:s}):yield this.userService.createUser({name:o,email:e,password:i,role:s}),this.router.navigate(["/admin/users"])}catch(o){this.errorMessage=o.message||"Failed to save user"}finally{this.loading=!1}})}static \u0275fac=function(e){return new(e||t)(p(G),p(y),p(b),p(V))};static \u0275cmp=F({type:t,selectors:[["app-user-form"]],standalone:!0,features:[E],decls:30,vars:10,consts:[[1,"p-8","max-w-md","mx-auto"],[1,"text-2xl","font-bold","mb-4"],[3,"ngSubmit","formGroup"],[1,"mb-4"],[1,"block","mb-1"],["type","text","formControlName","name",1,"w-full","border","rounded","px-3","py-2"],["class","text-red-500 text-sm",4,"ngIf"],["type","email","formControlName","email",1,"w-full","border","rounded","px-3","py-2"],["class","mb-4",4,"ngIf"],["formControlName","role",1,"w-full","border","rounded","px-3","py-2"],["value","Admin"],["value","Sales Team"],["value","Read-Only"],["type","submit",1,"bg-blue-500","text-white","px-4","py-2","rounded",3,"disabled"],[4,"ngIf"],["class","text-red-500 text-sm mt-2",4,"ngIf"],[1,"text-red-500","text-sm"],["type","password","formControlName","password",1,"w-full","border","rounded","px-3","py-2"],[1,"text-red-500","text-sm","mt-2"]],template:function(e,i){if(e&1&&(n(0,"div",0)(1,"h2",1),m(2),r(),n(3,"form",2),S("ngSubmit",function(){return i.onSubmit()}),n(4,"div",3)(5,"label",4),m(6,"Name"),r(),_(7,"input",5),d(8,B,2,1,"div",6),r(),n(9,"div",3)(10,"label",4),m(11,"Email"),r(),_(12,"input",7),d(13,H,3,2,"div",6),r(),d(14,L,5,1,"div",8),n(15,"div",3)(16,"label",4),m(17,"Role"),r(),n(18,"select",9)(19,"option",10),m(20,"Admin"),r(),n(21,"option",11),m(22,"Sales Team"),r(),n(23,"option",12),m(24,"Read-Only"),r()(),d(25,W,2,1,"div",6),r(),n(26,"button",13),d(27,X,2,0,"span",14)(28,Y,2,1,"span",14),r(),d(29,Z,2,1,"div",15),r()()),e&2){let s,v,f;l(2),g(i.isEdit?"Edit User":"Create User"),l(),a("formGroup",i.userForm),l(5),a("ngIf",((s=i.userForm.get("name"))==null?null:s.touched)&&((s=i.userForm.get("name"))==null?null:s.invalid)),l(5),a("ngIf",((v=i.userForm.get("email"))==null?null:v.touched)&&((v=i.userForm.get("email"))==null?null:v.invalid)),l(),a("ngIf",!i.isEdit),l(11),a("ngIf",((f=i.userForm.get("role"))==null?null:f.touched)&&((f=i.userForm.get("role"))==null?null:f.invalid)),l(),a("disabled",i.loading),l(),a("ngIf",i.loading),l(),a("ngIf",!i.loading),l(),a("ngIf",i.errorMessage)}},dependencies:[D,N,A,O,U,R,w,T,q,M,h,I],encapsulation:2})};export{j as UserFormComponent};
