rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Relaxed rules for development - authenticated users can read/write most collections
    
    // Users collection
    match /users/{userId} {
      allow read, write: if request.auth != null;
    }
    
    // User roles collection
    match /userRoles/{userId} {
      allow read, write: if request.auth != null;
    }
    
    // Clients collection
    match /clients/{clientId} {
      allow read, write: if request.auth != null;
    }
    
    // Solutions collection
    match /solutions/{solutionId} {
      allow read, write: if request.auth != null;
    }

    // Pipeline stages collection
    match /pipelineStages/{stageId} {
      allow read, write: if request.auth != null;
    }

    // Opportunities collection with relaxed validation for multiple solutions
    match /opportunities/{opportunityId} {
      allow read, write: if request.auth != null;
    }

    // Communications collection
    match /communications/{communicationId} {
      allow read, write: if request.auth != null;
    }

    // Action items collection
    match /actionItems/{actionItemId} {
      allow read, write: if request.auth != null;
    }

    // Stakeholders collection
    match /stakeholders/{stakeholderId} {
      allow read, write: if request.auth != null;
    }

    // Audit entries collection
    match /auditEntries/{auditId} {
      allow read, write: if request.auth != null;
    }

    // Contacts collection
    match /contacts/{contactId} {
      allow read, write: if request.auth != null;
    }

    // Fallback rule for any other collections
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
}